<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">

  <metal:javascriptslot fill-slot="javascript_head_slot">

    <!-- when opencore.tagging is added, this can go away -->
    <script type="text/javascript"
      tal:attributes="src string:${context/absolute_url}/++resource++MochiKit.js;"
      src="++resource++MochiKit.js">
    </script>

    <!-- when opencore.tagging is added, this should go into portal_javascript -->
    <script type="text/javascript"
      tal:attributes="src string:${context/absolute_url}/++resource++projpage.js;"
      src="++resource++projpage.js">
    </script>
  </metal:javascriptslot>

<body>

    <div metal:fill-slot="main">
    <metal:main-macro define-macro="main">

      <!-- XXX is this comment obselete? Nov 22, 2006 -->
        <!-- div class="documentDescription" tal:content="here/Description">
            description
            </div -->

	<!-- XXX why is this div here? Nov 22, 2006 -->
	<div>
	  
	  <!-- XXX is this comment obselete? Nov 22, 2006 -->
          <!-- a href=""
             class="link-parent"
             tal:define="parent_url portal_url"
             tal:condition="parent_url"
             tal:attributes="href parent_url"
             i18n:translate="go_to_homepage">
            OpenPlans 
            </a -->

	    <div id="column-one" 
		 tal:define="txt view/leftcolumn/txt">

              <div class="stx"
		   tal:condition="txt"
		   tal:attributes="class view/leftcolumn/class">
		<div tal:replace="structure txt" />
              </div>
	    </div>

	    <div id="column-two">

	      <div id="abc-click">
		<a id="abc-show-all" tal:attributes="name string:all">show all</a>
		<ul tal:repeat="letter view/alpha">
		  <li>
		    <a class="abc-letter" tal:attributes="name letter" tal:content="letter" />
		  </li>
		</ul>
	      </div>

	      <div id="project-list">
		  <tal:projectfinder define="limit_display limit_display|request/limit_display|nothing;
					     more_url more_url|request/more_url|string:folder_contents;
					     allProjects view/allprojects;
					     over_limit python: limit_display and len(allProjects) > limit_display;
					     allProjects python: (over_limit and allProjects[:limit_display]) or allProjects;
					     show_about python:not isAnon or site_properties.allowAnonymousViewAbout">
		    <tal:projects condition="allProjects"
				  define="toLocalizedTime nocall:here/toLocalizedTime;">
		      <table id="projects-table">
			<thead>
			  <tr>
			    <th mochi:format="str">project</th>
			    <th mochi:format="isodate">updated</th>
			  </tr>
			</thead>
			<tbody>
			  <tal:block  tal:repeat="item allProjects" >
			    <tr tal:define="item_url item/getURL|item/absolute_url;
					    item_id item/getId|item/id;
					    item_title_or_id item/getFull_name;
					    item_description item/Description;
					    item_modified item/ModificationDate;
					    item_created item/CreationDate;
					    ">
			      <td class="project-title">
				<a href="#" 
				   tal:attributes="href item_url"
				   tal:content="item_title_or_id">
				  Project Nav Name
				</a>
				<ul class="project-info" tal:condition="nothing">
				  <li class="project-members">
				    <tal:team_members repeat="mid item/projectMemberIds">
				      <a tal:attributes="href string:@@personal_projects" content="mid" />
				      <tal:comma condition="not:repeat/item/end" replace="string:," />
				    </tal:team_members>
				  </li>
				  <li class="project-tags">
				    <tal:team_members repeat="tag item/Subject">
				      <a tal:attributes="href string:@@tag_projects" content="mid" />
				      <tal:comma condition="not:repeat/item/end" replace="string:," />
				    </tal:team_members>
				  </li>
				  <li>
				    <span tal:omit-tag="" tal:content="item_description"> 
				      description 
				    </span> 
				  </li>
				</ul>
			      </td>
			      <td>
				<tal:modified>
				  <span tal:replace="python:here.translation_service.ulocalized_time(item_modified, None, here, domain='plone')">
                                    August 16, 2001 at 23:35:59
				  </span>
				</tal:modified>
			      </td>


			    </tr>
			  </tal:block>
			</tbody>
		      </table>
		    </tal:projects>
		    <metal:empty metal:define-slot="no_items_in_listing">
		      <p class="discreet"
			 tal:condition="not: allProjects"
			 i18n:translate="description_no_projects">
			There are no projects currently.
		      </p>
		    </metal:empty>
		  </tal:projectfinder>
		</div>
	      </div>
	  </div>
    </metal:main-macro>
    </div>

</body>
</html>
